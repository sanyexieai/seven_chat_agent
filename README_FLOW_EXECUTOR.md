# 流程图驱动的智能体系统

这是一个基于流程图的智能体执行系统，支持可视化设计、实时执行监控和智能体流程管理。

## 功能特性

### 🎯 核心功能
- **可视化流程图设计**：使用ReactFlow构建直观的智能体流程图
- **实时执行监控**：实时跟踪流程执行状态和进度
- **智能节点管理**：支持多种节点类型（LLM、工具、条件、动作等）
- **执行控制**：开始、暂停、恢复、停止和重置流程执行
- **进度跟踪**：实时显示节点执行状态、进度条和执行时间

### 🚀 高级特性
- **视野跟随**：流程图自动跟随当前执行节点
- **实时更新**：不受滚动条影响，实时更新执行状态
- **执行日志**：详细的执行日志和错误追踪
- **状态持久化**：支持流程图的保存、导出和导入
- **响应式设计**：支持紧凑模式和完整模式切换

## 系统架构

### 前端组件
- **FlowExecutionPage**: 主页面，整合所有功能
- **FlowExecutionTracker**: 执行状态跟踪器
- **RealTimeFlowDisplay**: 实时流程图显示组件
- **FlowExecutionEngine**: 流程执行引擎

### 后端服务
- **FlowExecutionEngine**: 核心执行引擎，管理节点执行逻辑
- **API接口**: 支持流程图的CRUD操作

## 使用方法

### 1. 启动系统
```bash
# 前端
cd agent-ui
npm start

# 后端
cd agent-backend
python main.py
```

### 2. 设计流程图
1. 打开流程图执行器页面
2. 在"设计模式"下创建节点和连接
3. 配置每个节点的参数和属性
4. 保存流程图配置

### 3. 执行流程
1. 切换到"执行模式"
2. 点击"开始执行"按钮
3. 实时监控执行进度和状态
4. 使用控制按钮管理执行过程

### 4. 监控执行
- 查看实时执行进度
- 监控节点状态变化
- 查看执行日志
- 分析执行结果

## 节点类型

### 🔴 开始节点 (Start)
- 流程的入口点
- 自动识别入度为0的节点
- 支持配置初始参数

### 🤖 LLM节点
- 调用大语言模型
- 支持系统提示词和用户提示词
- 可配置输出变量名

### 🛠️ 工具节点 (Tool)
- 调用外部工具和服务
- 支持参数配置
- 可设置结果保存方式

### 🔀 条件节点 (Condition)
- 基于条件进行流程分支
- 支持复杂的条件表达式
- 动态路由控制

### ⚡ 动作节点 (Action)
- 执行特定动作
- 支持自定义动作逻辑
- 可配置执行参数

### 📤 输出节点 (Output)
- 流程的出口点
- 收集和整理执行结果
- 支持结果格式化

## 执行状态

### 节点状态
- **pending**: 等待执行
- **running**: 正在执行
- **completed**: 执行完成
- **failed**: 执行失败
- **skipped**: 跳过执行

### 流程状态
- **isRunning**: 流程是否正在运行
- **isPaused**: 流程是否已暂停
- **currentNodeId**: 当前执行节点ID
- **executionProgress**: 整体执行进度

## 配置选项

### 流程图配置
```typescript
interface FlowConfig {
  nodes: FlowNode[];
  edges: FlowEdge[];
  metadata: {
    name: string;
    description: string;
    version: string;
  };
}
```

### 执行配置
```typescript
interface ExecutionConfig {
  autoStart: boolean;
  maxRetries: number;
  timeout: number;
  parallelExecution: boolean;
}
```

## 扩展开发

### 添加新节点类型
1. 在`FlowExecutionEngine`中注册新的执行器
2. 实现节点执行逻辑
3. 添加节点配置界面
4. 更新类型定义

### 自定义执行逻辑
1. 继承`FlowExecutionEngine`类
2. 重写相关方法
3. 实现自定义的执行策略
4. 集成到现有系统

## 最佳实践

### 流程图设计
- 保持流程图的清晰和简洁
- 合理使用条件节点进行分支控制
- 为关键节点添加详细的配置说明
- 测试各种执行路径

### 性能优化
- 避免创建过于复杂的流程图
- 合理设置执行超时时间
- 监控资源使用情况
- 优化节点执行逻辑

### 错误处理
- 为每个节点添加适当的错误处理
- 记录详细的执行日志
- 实现重试机制
- 提供用户友好的错误信息

## 故障排除

### 常见问题
1. **流程无法启动**
   - 检查是否有开始节点
   - 验证节点配置是否正确
   - 查看控制台错误信息

2. **执行卡住**
   - 检查节点间的连接关系
   - 验证条件节点的逻辑
   - 查看执行日志

3. **性能问题**
   - 检查节点执行时间
   - 优化复杂的计算逻辑
   - 考虑并行执行

### 调试技巧
- 使用执行日志追踪问题
- 检查节点状态变化
- 验证数据流转过程
- 测试单个节点功能

## 技术栈

- **前端**: React + TypeScript + Ant Design + ReactFlow
- **后端**: Python + FastAPI + SQLAlchemy
- **状态管理**: React Hooks + Zustand
- **动画**: Framer Motion
- **样式**: CSS + Ant Design 主题

## 贡献指南

1. Fork 项目
2. 创建功能分支
3. 提交更改
4. 推送到分支
5. 创建 Pull Request

## 许可证

MIT License

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 Issue
- 发送邮件
- 参与讨论

---

**注意**: 这是一个演示系统，生产环境使用前请进行充分的测试和安全评估。 