{
  "metadata": {
    "name": "路由节点架构示例",
    "description": "展示如何使用LLM节点生成JSON + 路由节点进行分支选择的架构",
    "version": "1.0.0"
  },
  "nodes": [
    {
      "id": "llm_judge",
      "type": "llm",
      "position": { "x": 250, "y": 50 },
      "data": {
        "label": "智能判断",
        "nodeType": "llm",
        "isStartNode": true,
        "config": {
          "system_prompt": "你是一个智能判断器，请分析用户问题并输出判断结果。",
          "user_prompt": "请分析以下用户问题，并输出JSON格式的判断结果：\n\n用户问题：{{message}}\n\n请输出：{\"can_direct_answer\": true|false, \"domain\": \"技术|生活|工作|其他\", \"requires_tool\": true|false, \"confidence\": 0.0-1.0}",
          "save_as": "judge_result"
        }
      }
    },
    {
      "id": "router_1",
      "type": "router",
      "position": { "x": 250, "y": 150 },
      "data": {
        "label": "直接回答路由",
        "nodeType": "router",
        "config": {
          "routing_logic": {
            "field": "can_direct_answer",
            "true_branch": "direct_answer",
            "false_branch": "tool_required"
          }
        }
      }
    },
    {
      "id": "direct_answer",
      "type": "llm",
      "position": { "x": 100, "y": 250 },
      "data": {
        "label": "直接回答",
        "nodeType": "llm",
        "config": {
          "system_prompt": "你是一个智能助手，请直接回答用户问题。",
          "user_prompt": "用户问题：{{message}}\n\n请直接回答，无需查询外部信息。",
          "save_as": "direct_answer_result"
        }
      }
    },
    {
      "id": "tool_required",
      "type": "llm",
      "position": { "x": 400, "y": 250 },
      "data": {
        "label": "工具选择",
        "nodeType": "llm",
        "config": {
          "system_prompt": "你是一个工具选择器，请根据用户问题选择最合适的工具。",
          "user_prompt": "用户问题：{{message}}\n\n请输出：{\"selected_tool\": \"工具名\", \"reason\": \"选择原因\"}",
          "save_as": "tool_selection"
        }
      }
    },
    {
      "id": "router_2",
      "type": "router",
      "position": { "x": 250, "y": 350 },
      "data": {
        "label": "工具路由",
        "nodeType": "router",
        "config": {
          "routing_logic": {
            "field": "requires_tool",
            "true_branch": "call_tool",
            "false_branch": "final_answer"
          }
        }
      }
    },
    {
      "id": "call_tool",
      "type": "tool",
      "position": { "x": 100, "y": 450 },
      "data": {
        "label": "调用工具",
        "nodeType": "tool",
        "config": {
          "server": "ddg",
          "tool": "search",
          "params": { "query": "{{message}}" },
          "save_as": "tool_result",
          "append_to_output": true
        }
      }
    },
    {
      "id": "final_answer",
      "type": "llm",
      "position": { "x": 400, "y": 450 },
      "data": {
        "label": "最终回答",
        "nodeType": "llm",
        "config": {
          "system_prompt": "你是一个智能助手，请根据前面的处理结果，为用户提供最终的综合回答。",
          "user_prompt": "用户问题：{{message}}\n\n处理结果：{{last_output}}",
          "save_as": "final_answer"
        }
      }
    }
  ],
  "edges": [
    {
      "id": "edge_1",
      "source": "llm_judge",
      "target": "router_1"
    },
    {
      "id": "edge_2",
      "source": "router_1",
      "sourceHandle": "source-true",
      "target": "direct_answer"
    },
    {
      "id": "edge_3",
      "source": "router_1",
      "sourceHandle": "source-false",
      "target": "tool_required"
    },
    {
      "id": "edge_4",
      "source": "direct_answer",
      "target": "router_2"
    },
    {
      "id": "edge_5",
      "source": "tool_required",
      "target": "router_2"
    },
    {
      "id": "edge_6",
      "source": "router_2",
      "sourceHandle": "source-true",
      "target": "call_tool"
    },
    {
      "id": "edge_7",
      "source": "router_2",
      "sourceHandle": "source-false",
      "target": "final_answer"
    },
    {
      "id": "edge_8",
      "source": "call_tool",
      "target": "final_answer"
    }
  ]
} 